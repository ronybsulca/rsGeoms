
ext_tracks <- reading_tropical_cyclone(filename = "data/ebtrk_atlc_1988_2015.txt")
ext_tracks <- tc_geom_format(ext_tracks)


## STORMS

katrina <- ext_tracks %>%
    dplyr::filter(storm_id == "KATRINA-2005", date == "2005-08-29 12:00:00") %>%
    dplyr::mutate(longitude = longitude * -1) %>%
    as.data.frame()

ike <- ext_tracks %>%
    dplyr::filter(storm_id == "IKE-2008", date == "2008-09-12 18:00:00") %>%
    dplyr::mutate(longitude = longitude * -1) %>%
    as.data.frame()

## Maps

ggmap::get_map("Louisiana", zoom = 6, maptype = "toner-background") %>%
    ggmap::ggmap(extent = "device") +
    geom_hurricane(data = katrina,
                   aes(x = longitude, y = latitude,
                       r_ne = ne, r_se = se, r_nw = nw, r_sw = sw,
                       fill = wind_speed, color = wind_speed)) +
    ggplot2::scale_color_manual(name = "Wind speed (kts)",
                       values = c("red", "orange", "yellow")) +
    ggplot2::scale_fill_manual(name = "Wind speed (kts)",
                      values = c("red", "orange", "yellow"))


ggmap::get_map("Louisiana", zoom = 6, maptype = "toner-background") %>%
    ggmap::ggmap(extent = "device") +
    geom_hurricane(data = ike,
                   aes(x = longitude, y = latitude,
                       r_ne = ne, r_se = se, r_nw = nw, r_sw = sw,
                       fill = wind_speed, color = wind_speed, scale_radii = 0.9)) +
    ggplot2::scale_color_manual(name = "Wind speed (kts)",
                       values = c("red", "orange", "yellow")) +
    ggplot2::scale_fill_manual(name = "Wind speed (kts)",
                      values = c("red", "orange", "yellow"))



# ggplot(data = ike) +
#     geom_hurricane(aes(x = longitude, y = latitude,
#                        r_ne = ne, r_se = se, r_nw = nw, r_sw = sw,
#                        fill = wind_speed, color = wind_speed)) +
#     scale_color_manual(name = "Wind speed (kts)",
#                        values = c("red", "orange", "yellow")) +
#     scale_fill_manual(name = "Wind speed (kts)",
#                       values = c("red", "orange", "yellow"))
